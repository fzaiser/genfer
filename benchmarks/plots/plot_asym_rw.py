import re
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.ticker as ticker
from util import hitting_time_prob, parse_output

# cargo run --bin bound -- asym_rw.sgcl --limit 200 --solver adam-barrier --optimizer adam-barrier --objective tail
tail_output = """

Probability masses:
p(0) = 0.0
p(1) ∈ [0.75, 1.0]
p(2) ∈ [0.0, 1.0]
p(3) ∈ [0.140625, 1.0]
p(4) ∈ [0.0, 1.0]
p(5) ∈ [0.052734375, 1.0]
p(6) ∈ [0.0, 1.0]
p(7) ∈ [0.02471923828125, 1.0]
p(8) ∈ [0.0, 1.0]
p(9) ∈ [0.0, 1.0]
p(10) ∈ [0.0, 1.0]
p(11) ∈ [0.0, 1.0]
p(12) ∈ [0.0, 1.0]
p(13) ∈ [0.0, 1.0]
p(14) ∈ [0.0, 1.0]
p(15) ∈ [0.0, 1.0]
p(16) ∈ [0.0, 1.0]
p(17) ∈ [0.0, 1.0]
p(18) ∈ [0.0, 1.0]
p(19) ∈ [0.0, 1.0]
p(20) ∈ [0.0, 1.0]
p(21) ∈ [0.0, 1.0]
p(22) ∈ [0.0, 1.0]
p(23) ∈ [0.0, 1.0]
p(24) ∈ [0.0, 1.0]
p(25) ∈ [0.0, 1.0]
p(26) ∈ [0.0, 1.0]
p(27) ∈ [0.0, 1.0]
p(28) ∈ [0.0, 1.0]
p(29) ∈ [0.0, 1.0]
p(30) ∈ [0.0, 1.0]
p(31) ∈ [0.0, 1.0]
p(32) ∈ [0.0, 1.0]
p(33) ∈ [0.0, 1.0]
p(34) ∈ [0.0, 1.0]
p(35) ∈ [0.0, 1.0]
p(36) ∈ [0.0, 1.0]
p(37) ∈ [0.0, 1.0]
p(38) ∈ [0.0, 0.9022563564944857]
p(39) ∈ [0.0, 0.7838986779700229]
p(40) ∈ [0.0, 0.6810671190066648]
p(41) ∈ [0.0, 0.5917249685804123]
p(42) ∈ [0.0, 0.5141026907188916]
p(43) ∈ [0.0, 0.4466628765699737]
p(44) ∈ [0.0, 0.38806979404597836]
p(45) ∈ [0.0, 0.33716293193507774]
p(46) ∈ [0.0, 0.29293401448706735]
p(47) ∈ [0.0, 0.2545070312178699]
p(48) ∈ [0.0, 0.22112088639741592]
p(49) ∈ [0.0, 0.19211432457173644]
p(50) ∈ [0.0, 0.1669128335498831]
p(51) ∈ [0.0, 0.14501726545251944]
p(52) ∈ [0.0, 0.1259939504474443]
p(53) ∈ [0.0, 0.10946610736188898]
p(54) ∈ [0.0, 0.09510638104773919]
p(55) ∈ [0.0, 0.08263035869262024]
p(56) ∈ [0.0, 0.07179093665906434]
p(57) ∈ [0.0, 0.06237342627977832]
p(58) ∈ [0.0, 0.05419130167300488]
p(59) ∈ [0.0, 0.047082505358002257]
p(60) ∈ [0.0, 0.04090623849861462]
p(61) ∈ [0.0, 0.035540172201586964]
p(62) ∈ [0.0, 0.030878024635807872]
p(63) ∈ [0.0, 0.026827455984216746]
p(64) ∈ [0.0, 0.0233082395351958]
p(65) ∈ [0.0, 0.02025067268956423]
p(66) ∈ [0.0, 0.01759419641112838]
p(67) ∈ [0.0, 0.015286195777233908]
p(68) ∈ [0.0, 0.013280957872683984]
p(69) ∈ [0.0, 0.011538766386774878]
p(70) ∈ [0.0, 0.010025114980781015]
p(71) ∈ [0.0, 0.008710023845622793]
p(72) ∈ [0.0, 0.007567445913264465]
p(73) ∈ [0.0, 0.006574750961096634]
p(74) ∈ [0.0, 0.005712277391328401]
p(75) ∈ [0.0, 0.004962942807804704]
p(76) ∈ [0.0, 0.00431190567722281]
p(77) ∈ [0.0, 0.00374627137351407]
p(78) ∈ [0.0, 0.003254836783222563]
p(79) ∈ [0.0, 0.002827868413462336]
p(80) ∈ [0.0, 0.0024569096075964963]
p(81) ∈ [0.0, 0.00213461305029721]
p(82) ∈ [0.0, 0.0018545952445343263]
p(83) ∈ [0.0, 0.00161131007822258]
p(84) ∈ [0.0, 0.001399938976352531]
p(85) ∈ [0.0, 0.0012162954629271856]
p(86) ∈ [0.0, 0.001056742242430946]
p(87) ∈ [0.0, 0.0009181191585229455]
p(88) ∈ [0.0, 0.000797680603084214]
p(89) ∈ [0.0, 0.0006930411359245077]
p(90) ∈ [0.0, 0.0006021282380772951]
p(91) ∈ [0.0, 0.0005231412629012557]
p(92) ∈ [0.0, 0.00045451577196216613]
p(93) ∈ [0.0, 0.0003948925493215342]
p(94) ∈ [0.0, 0.00034309068052019277]
p(95) ∈ [0.0, 0.0002980841630515665]
p(96) ∈ [0.0, 0.00025898158506501123]
p(97) ∈ [0.0, 0.0002250084698098595]
p(98) ∈ [0.0, 0.00019549193612922435]
p(99) ∈ [0.0, 0.00016984737118494963]
p(100) ∈ [0.0, 0.00014756685144991772]
p(101) ∈ [0.0, 0.00012820908263060405]
p(102) ∈ [0.0, 0.00011139065926713055]
p(103) ∈ [0.0, 0.0000967784708959782]
p(104) ∈ [0.0, 0.00008408310436966295]
p(105) ∈ [0.0, 0.0000730531116578474]
p(106) ∈ [0.0, 0.0000634700295963313]
p(107) ∈ [0.0, 0.00005514405294365628]
p(108) ∈ [0.0, 0.00004791027504465722]
p(109) ∈ [0.0, 0.00004162542164247585]
p(110) ∈ [0.0, 0.00003616501314799108]
p(111) ∈ [0.0, 0.00003142089916176941]
p(112) ∈ [0.0, 0.000027299116416577967]
p(113) ∈ [0.0, 0.00002371802771426195]
p(114) ∈ [0.0, 0.000020606704996242315]
p(115) ∈ [0.0, 0.000017903524522269566]
p(116) ∈ [0.0, 0.000015554946333145368]
p(117) ∈ [0.0, 0.000013514453823104577]
p(118) ∈ [0.0, 0.000011741632418727489]
p(119) ∈ [0.0, 0.000010201369116435474]
p(120) ∈ [0.0, 8.86315702438264e-6]
p(121) ∈ [0.0, 7.700491134302956e-6]
p(122) ∈ [0.0, 6.690343355798637e-6]
p(123) ∈ [0.0, 5.812706415450043e-6]
p(124) ∈ [0.0, 5.050197587083453e-6]
p(125) ∈ [0.0, 4.38771440456603e-6]
p(126) ∈ [0.0, 3.8121355380779286e-6]
p(127) ∈ [0.0, 3.3120609093321402e-6]
p(128) ∈ [0.0, 2.8775858983904255e-6]
p(129) ∈ [0.0, 2.5001051699514645e-6]
p(130) ∈ [0.0, 2.1721422336390607e-6]
p(131) ∈ [0.0, 1.8872013625131147e-6]
p(132) ∈ [0.0, 1.6396389368594025e-6]
p(133) ∈ [0.0, 1.4245516650567537e-6]
p(134) ∈ [0.0, 1.2376794675924337e-6]
p(135) ∈ [0.0, 1.0753211007189842e-6]
p(136) ∈ [0.0, 9.342608485707392e-7]
p(137) ∈ [0.0, 8.117048317832829e-7]
p(138) ∈ [0.0, 7.052256711263016e-7]
p(139) ∈ [0.0, 6.127144101420456e-7]
p(140) ∈ [0.0, 5.323387445555418e-7]
p(141) ∈ [0.0, 4.6250673113640886e-7]
p(142) ∈ [0.0, 4.018352572196964e-7]
p(143) ∈ [0.0, 3.491226463841369e-7]
p(144) ∈ [0.0, 3.033248577081024e-7]
p(145) ∈ [0.0, 2.635348071989781e-7]
p(146) ∈ [0.0, 2.2896440183031994e-7]
p(147) ∈ [0.0, 1.9892893034783718e-7]
p(148) ∈ [0.0, 1.7283350168407862e-7]
p(149) ∈ [0.0, 1.501612623772155e-7]
p(150) ∈ [0.0, 1.304631596247761e-7]
p(151) ∈ [0.0, 1.1334904721647044e-7]
p(152) ∈ [0.0, 9.847995818768825e-8]
p(153) ∈ [0.0, 8.556139114365304e-8]
p(154) ∈ [0.0, 7.433747728126487e-8]
p(155) ∈ [0.0, 6.458591257901133e-8]
p(156) ∈ [0.0, 5.6113554780463204e-8]
p(157) ∈ [0.0, 4.875259796396059e-8]
p(158) ∈ [0.0, 4.235724893093209e-8]
p(159) ∈ [0.0, 3.680083958445103e-8]
p(160) ∈ [0.0, 3.197331810497958e-8]
p(161) ∈ [0.0, 2.7779069232815845e-8]
p(162) ∈ [0.0, 2.4135020485139878e-8]
p(163) ∈ [0.0, 2.0968996798856247e-8]
p(164) ∈ [0.0, 1.8218291010822618e-8]
p(165) ∈ [0.0, 1.582842186199027e-8]
p(166) ∈ [0.0, 1.37520549261343e-8]
p(167) ∈ [0.0, 1.1948065090781884e-8]
p(168) ∈ [0.0, 1.0380722021569869e-8]
p(169) ∈ [0.0, 9.018982477107832e-9]
p(170) ∈ [0.0, 7.835875457733992e-9]
p(171) ∈ [0.0, 6.807968010245839e-9]
p(172) ∈ [0.0, 5.914901108182481e-9]
p(173) ∈ [0.0, 5.138986415171915e-9]
p(174) ∈ [0.0, 4.464855944723723e-9]
p(175) ∈ [0.0, 3.879157677529662e-9]
p(176) ∈ [0.0, 3.370291107582074e-9]
p(177) ∈ [0.0, 2.928177479261526e-9]
p(178) ∈ [0.0, 2.5440601646442745e-9]
p(179) ∈ [0.0, 2.210331227245872e-9]
p(180) ∈ [0.0, 1.920380737073241e-9]
p(181) ∈ [0.0, 1.6684658524763877e-9]
p(182) ∈ [0.0, 1.4495970757977821e-9]
p(183) ∈ [0.0, 1.259439429966529e-9]
p(184) ∈ [0.0, 1.0942265987129295e-9]
p(185) ∈ [0.0, 9.506863298401628e-10]
p(186) ∈ [0.0, 8.25975624069135e-10]
p(187) ∈ [0.0, 7.176244257883671e-10]
p(188) ∈ [0.0, 6.234867004319475e-10]
p(189) ∈ [0.0, 5.416979295102172e-10]
p(190) ∈ [0.0, 4.706381814277118e-10]
p(191) ∈ [0.0, 4.0890002665850303e-10]
p(192) ∈ [0.0, 3.5526066179780547e-10]
p(193) ∈ [0.0, 3.086576903709042e-10]
p(194) ∈ [0.0, 2.681680807072388e-10]
p(195) ∈ [0.0, 2.3298988411332705e-10]
p(196) ∈ [0.0, 2.0242635124947678e-10]
p(197) ∈ [0.0, 1.7587213211473801e-10]
p(198) ∈ [0.0, 1.528012863130823e-10]
p(199) ∈ [0.0, 1.327568661287411e-10]

Asymptotics: p(n) <= 188.7950696915578 * 0.8688203439382628^n for n >= 9

Moments:
0-th (raw) moment ∈ [0.96807861328125, 1251.3829852209833]
1-th (raw) moment ∈ [1.60858154296875, 9533.688052914795]
2-th (raw) moment ∈ [4.54522705078125, 67900.54499408511]
3-th (raw) moment ∈ [19.61737060546875, 482857.37233131874]
4-th (raw) moment ∈ [104.45050048828125, 3433780.2849978227]
Total time: 0.17447s
"""


geom_bound_output = """
Probability masses:
p(0) = 0.0
p(1) = 0.75
p(2) = 0.0
p(3) ∈ [0.140625, 0.14730307336868514]
p(4) ∈ [0.0, 0.006187240174161751]
p(5) ∈ [0.052734375, 0.05846685783738138]
p(6) ∈ [0.0, 0.0053111498108806]
p(7) ∈ [0.02471923828125, 0.02964002271512067]
p(8) ∈ [0.0, 0.004559110608218583]
p(9) ∈ [0.01297760009765625, 0.017201619624888708]
p(10) ∈ [0.0, 0.003913557379870807]
p(11) ∈ [0.007299900054931641, 0.010925814013614529]
p(12) ∈ [0.0, 0.003359412105056555]
p(13) ∈ [0.004301726818084717, 0.007414224748316913]
p(14) ∈ [0.0, 0.0028837317550645114]
p(15) ∈ [0.0026213647797703743, 0.00529314449547514]
p(16) ∈ [0.0, 0.002475405986258852]
p(17) ∈ [0.001638352987356484, 0.003931818560430424]
p(18) ∈ [0.0, 0.002124897638639444]
p(19) ∈ [0.0010444500294397585, 0.0030131693456158276]
p(20) ∈ [0.0, 0.0018240199788477577]
p(21) ∈ [0.0006765187690689345, 0.0023664746992510238]
p(22) ∈ [0.0, 0.0015657454847406483]
p(23) ∈ [0.00044396544220148826, 0.0018946298525577853]
p(24) ∈ [0.0, 0.001344041705362454]
p(25) ∈ [0.00029455399530675663, 0.0015398096814994943]
p(26) ∈ [0.0, 0.0011537303625389894]
p(27) ∈ [0.00019724597900006025, 0.001266178057932422]
p(28) ∈ [0.0, 0.0009903664031655816]
p(29) ∈ [0.00013314103582504067, 0.0010507162792387937]
p(30) ∈ [0.0, 0.0008501341772445421]
p(31) ∈ [0.00009049429778733233, 0.0008781442747313615]
p(32) ∈ [0.0, 0.0007297583167291874]
p(33) ∈ [0.00006188213010457284, 0.0007380037785830316]
p(34) ∈ [0.0, 0.0006264272335944791]
p(35) ∈ [0.000042543964446893823, 0.0006229292839702551]
p(36) ∈ [0.0, 0.0005377274502983916]
p(37) ∈ [0.00002938892280870955, 0.0005275938240661585]
p(38) ∈ [0.0, 0.0004615872288074763]
p(39) ∈ [0.00002038856519854225, 0.0004480494919786756]
p(40) ∈ [0.0, 0.0003962281815442643]
p(41) ∈ [0.0, 0.00036710571861662915]
p(42) ∈ [0.0, 0.0003401237340458489]
p(43) ∈ [0.0, 0.0003151249043387991]
p(44) ∈ [0.0, 0.00029196346915664253]
p(45) ∈ [0.0, 0.0002705043814319896]
p(46) ∈ [0.0, 0.00025062251995178604]
p(47) ∈ [0.0, 0.00023220195981474536]
p(48) ∈ [0.0, 0.00021513529650959198]
p(49) ∈ [0.0, 0.00019932301967302761]
p(50) ∈ [0.0, 0.0001846729328759996]
p(51) ∈ [0.0, 0.00017109961605522687]
p(52) ∈ [0.0, 0.00015852392745559023]
p(53) ∈ [0.0, 0.00014687254217936953]
p(54) ∈ [0.0, 0.00013607752465175232]
p(55) ∈ [0.0, 0.00012607593250979534]
p(56) ∈ [0.0, 0.00011680944960523855]
p(57) ∈ [0.0, 0.00010822404598132695]
p(58) ∈ [0.0, 0.00010026966284107124]
p(59) ∈ [0.0, 0.00009289992067009606]
p(60) ∈ [0.0, 0.0000860718488122318]
p(61) ∈ [0.0, 0.00007974563492108986]
p(62) ∈ [0.0, 0.00007388439282675204]
p(63) ∈ [0.0, 0.00006845394746407774]
p(64) ∈ [0.0, 0.00006342263560861301]
p(65) ∈ [0.0, 0.00005876112125825525]
p(66) ∈ [0.0, 0.000054442224584221884]
p(67) ∈ [0.0, 0.000050440763453989614]
p(68) ∈ [0.0, 0.000046733406602174355]
p(69) ∈ [0.0, 0.00004329853759323719]
p(70) ∈ [0.0, 0.0000401161287828255]
p(71) ∈ [0.0, 0.000037167624542857506]
p(72) ∈ [0.0, 0.00003443583306947209]
p(73) ∈ [0.0, 0.000031904826143010194]
p(74) ∈ [0.0, 0.000029559846255559503]
p(75) ∈ [0.0, 0.00002738722056455232]
p(76) ∈ [0.0, 0.000025374281170707005]
p(77) ∈ [0.0, 0.000023509291255478694]
p(78) ∈ [0.0, 0.000021781376647349865]
p(79) ∈ [0.0, 0.000020180462417945308]
p(80) ∈ [0.0, 0.000018697214138283275]
p(81) ∈ [0.0, 0.000017322983452646438]
p(82) ∈ [0.0, 0.000016049757652731005]
p(83) ∈ [0.0, 0.000014870112958056576]
p(84) ∈ [0.0, 0.000013777171230229547]
p(85) ∈ [0.0, 0.00001276455986867444]
p(86) ∈ [0.0, 0.000011826374653997774]
p(87) ∈ [0.0, 0.000010957145322335764]
p(88) ∈ [0.0, 0.000010151803669960676]
p(89) ∈ [0.0, 9.405654002173776e-6]
p(90) ∈ [0.0, 8.714345754181655e-6]
p(91) ∈ [0.0, 8.073848124316832e-6]
p(92) ∈ [0.0, 7.480426571696889e-6]
p(93) ∈ [0.0, 6.930621041287379e-6]
p(94) ∈ [0.0, 6.421225789405651e-6]
p(95) ∈ [0.0, 5.94927069203444e-6]
p(96) ∈ [0.0, 5.512003926959872e-6]
p(97) ∈ [0.0, 5.1068759287588264e-6]
p(98) ∈ [0.0, 4.731524523082255e-6]
p(99) ∈ [0.0, 4.383761153557096e-6]
p(100) ∈ [0.0, 4.0615581210001815e-6]
p(101) ∈ [0.0, 3.7630367605399854e-6]
p(102) ∈ [0.0, 3.4864564877107257e-6]
p(103) ∈ [0.0, 3.2302046496500197e-6]
p(104) ∈ [0.0, 2.992787122225615e-6]
p(105) ∈ [0.0, 2.772819598265983e-6]
p(106) ∈ [0.0, 2.5690195160991867e-6]
p(107) ∈ [0.0, 2.3801985813378572e-6]
p(108) ∈ [0.0, 2.2052558383071528e-6]
p(109) ∈ [0.0, 2.0431712507173716e-6]
p(110) ∈ [0.0, 1.8929997541521291e-6]
p(111) ∈ [0.0, 1.7538657456940277e-6]
p(112) ∈ [0.0, 1.6249579785585455e-6]
p(113) ∈ [0.0, 1.5055248319683666e-6]
p(114) ∈ [0.0, 1.3948699286882604e-6]
p(115) ∈ [0.0, 1.2923480746677409e-6]
p(116) ∈ [0.0, 1.1973614971168268e-6]
p(117) ∈ [0.0, 1.109356359080306e-6]
p(118) ∈ [0.0, 1.0278195301880801e-6]
p(119) ∈ [0.0, 9.522755947528418e-7]
p(120) ∈ [0.0, 8.822840797702478e-7]
p(121) ∈ [0.0, 8.174368866589184e-7]
p(122) ∈ [0.0, 7.573559117655504e-7]
p(123) ∈ [0.0, 7.016908417610494e-7]
p(124) ∈ [0.0, 6.501171110733335e-7]
p(125) ∈ [0.0, 6.023340094472335e-7]
p(126) ∈ [0.0, 5.58062928597268e-7]
p(127) ∈ [0.0, 5.170457377300761e-7]
p(128) ∈ [0.0, 4.79043278464685e-7]
p(129) ∈ [0.0, 4.4383397037496727e-7]
p(130) ∈ [0.0, 4.1121251902364246e-7]
p(131) ∈ [0.0, 3.8098871895477314e-7]
p(132) ∈ [0.0, 3.529863446653813e-7]
p(133) ∈ [0.0, 3.2704212308978747e-7]
p(134) ∈ [0.0, 3.0300478160555124e-7]
p(135) ∈ [0.0, 2.8073416601023404e-7]
p(136) ∈ [0.0, 2.601004233261835e-7]
p(137) ∈ [0.0, 2.409832446685297e-7]
p(138) ∈ [0.0, 2.232711637617947e-7]
p(139) ∈ [0.0, 2.0686090701498517e-7]
p(140) ∈ [0.0, 1.916567913656598e-7]
p(141) ∈ [0.0, 1.7757016638198887e-7]
p(142) ∈ [0.0, 1.6451889736987855e-7]
p(143) ∈ [0.0, 1.524268864713189e-7]
p(144) ∈ [0.0, 1.4122362896163084e-7]
p(145) ∈ [0.0, 1.3084380215851954e-7]
p(146) ∈ [0.0, 1.212268845459932e-7]
p(147) ∈ [0.0, 1.1231680289237667e-7]
p(148) ∈ [0.0, 1.0406160530487661e-7]
p(149) ∈ [0.0, 9.641315831438177e-8]
p(150) ∈ [0.0, 8.932686622429445e-8]
p(151) ∈ [0.0, 8.27614110870045e-8]
p(152) ∈ [0.0, 7.667851179189012e-8]
p(153) ∈ [0.0, 7.104270086016292e-8]
p(154) ∈ [0.0, 6.582111764511832e-8]
p(155) ∈ [0.0, 6.098331673200653e-8]
p(156) ∈ [0.0, 5.650109042036369e-8]
p(157) ∈ [0.0, 5.2348304253753824e-8]
p(158) ∈ [0.0, 4.850074463794643e-8]
p(159) ∈ [0.0, 4.49359776590396e-8]
p(160) ∈ [0.0, 4.163321827834111e-8]
p(161) ∈ [0.0, 3.8573209141323974e-8]
p(162) ∈ [0.0, 3.573810829402942e-8]
p(163) ∈ [0.0, 3.3111385152226814e-8]
p(164) ∈ [0.0, 3.0677724116759425e-8]
p(165) ∈ [0.0, 2.8422935273087186e-8]
p(166) ∈ [0.0, 2.633387165434359e-8]
p(167) ∈ [0.0, 2.439835258549349e-8]
p(168) ∈ [0.0, 2.260509266163563e-8]
p(169) ∈ [0.0, 2.0943635946344673e-8]
p(170) ∈ [0.0, 1.9404295006383867e-8]
p(171) ∈ [0.0, 1.7978094427318845e-8]
p(172) ∈ [0.0, 1.6656718480689898e-8]
p(173) ∈ [0.0, 1.5432462637606318e-8]
p(174) ∈ [0.0, 1.429818864605381e-8]
p(175) ∈ [0.0, 1.3247282909984861e-8]
p(176) ∈ [0.0, 1.2273617927513566e-8]
p(177) ∈ [0.0, 1.1371516563373113e-8]
p(178) ∈ [0.0, 1.0535718947319832e-8]
p(179) ∈ [0.0, 9.761351805478791e-9]
p(180) ∈ [0.0, 9.043900045811608e-9]
p(181) ∈ [0.0, 8.379180432030266e-9]
p(182) ∈ [0.0, 7.763317192457775e-9]
p(183) ∈ [0.0, 7.192719421618582e-9]
p(184) ∈ [0.0, 6.6640601427944995e-9]
p(185) ∈ [0.0, 6.174256909466475e-9]
p(186) ∈ [0.0, 5.720453832535297e-9]
p(187) ∈ [0.0, 5.300004928527578e-9]
p(188) ∈ [0.0, 4.910458691695645e-9]
p(189) ∈ [0.0, 4.549543800056079e-9]
p(190) ∈ [0.0, 4.215155872023292e-9]
p(191) ∈ [0.0, 3.905345196420228e-9]
p(192) ∈ [0.0, 3.6183053643237302e-9]
p(193) ∈ [0.0, 3.352362736460423e-9]
p(194) ∈ [0.0, 3.105966684740796e-9]
p(195) ∈ [0.0, 2.8776805510329423e-9]
p(196) ∈ [0.0, 2.666173270459384e-9]
p(197) ∈ [0.0, 2.470211610375064e-9]
p(198) ∈ [0.0, 2.288652979774416e-9]
p(199) ∈ [0.0, 2.1204387672014105e-9]

Asymptotics: p(n) <= 0.008396800223217074 * 0.9265007783794355^n for n >= 41

Moments:
0-th (raw) moment ∈ [0.9999521311502375, 1.0908112344365322]
1-th (raw) moment ∈ [1.9978060132708202, 3.415715587356788]
2-th (raw) moment ∈ [9.897808079284232, 23.804017585394877]
3-th (raw) moment ∈ [105.14617495597001, 264.7406681865964]
4-th (raw) moment ∈ [1717.9064492166108, 3310.0590843950336]
Total time: 0.79745s
"""

rest_output = """
Probability masses:
p(0) = 0
p(1) ∈ [0.75, 0.7500478688497625]
p(2) ∈ [0.0, 0.000047868849762444746]
p(3) ∈ [0.140625, 0.14067286884976246]
p(4) ∈ [0.0, 0.000047868849762444746]
p(5) ∈ [0.052734375, 0.05278224384976245]
p(6) ∈ [0.0, 0.000047868849762444746]
p(7) ∈ [0.02471923828125, 0.024767107131012447]
p(8) ∈ [0.0, 0.000047868849762444746]
p(9) ∈ [0.01297760009765625, 0.013025468947418696]
p(10) ∈ [0.0, 0.000047868849762444746]
p(11) ∈ [0.007299900054931641, 0.0073477689046940855]
p(12) ∈ [0.0, 0.000047868849762444746]
p(13) ∈ [0.004301726818084717, 0.004349595667847162]
p(14) ∈ [0.0, 0.000047868849762444746]
p(15) ∈ [0.0026213647797703743, 0.002669233629532819]
p(16) ∈ [0.0, 0.000047868849762444746]
p(17) ∈ [0.001638352987356484, 0.0016862218371189288]
p(18) ∈ [0.0, 0.000047868849762444746]
p(19) ∈ [0.0010444500294397585, 0.0010923188792022033]
p(20) ∈ [0.0, 0.000047868849762444746]
p(21) ∈ [0.0006765187690689345, 0.0007243876188313793]
p(22) ∈ [0.0, 0.000047868849762444746]
p(23) ∈ [0.00044396544220148826, 0.0004918342919639331]
p(24) ∈ [0.0, 0.000047868849762444746]
p(25) ∈ [0.00029455399530675663, 0.0003424228450692014]
p(26) ∈ [0.0, 0.000047868849762444746]
p(27) ∈ [0.00019724597900006025, 0.000245114828762505]
p(28) ∈ [0.0, 0.000047868849762444746]
p(29) ∈ [0.00013314103582504067, 0.0001810098855874854]
p(30) ∈ [0.0, 0.000047868849762444746]
p(31) ∈ [0.00009049429778733233, 0.00013836314754977707]
p(32) ∈ [0.0, 0.000047868849762444746]
p(33) ∈ [0.00006188213010457284, 0.00010975097986701759]
p(34) ∈ [0.0, 0.000047868849762444746]
p(35) ∈ [0.000042543964446893823, 0.00009041281420933857]
p(36) ∈ [0.0, 0.000047868849762444746]
p(37) ∈ [0.00002938892280870955, 0.0000772577725711543]
p(38) ∈ [0.0, 0.000047868849762444746]
p(39) ∈ [0.00002038856519854225, 0.00006825741496098699]
p(40) ∈ [0.0, 0.000047868849762444746]
p(41) ∈ [0.0, 0.000047868849762444746]
p(42) ∈ [0.0, 0.000047868849762444746]
p(43) ∈ [0.0, 0.000047868849762444746]
p(44) ∈ [0.0, 0.000047868849762444746]
p(45) ∈ [0.0, 0.000047868849762444746]
p(46) ∈ [0.0, 0.000047868849762444746]
p(47) ∈ [0.0, 0.000047868849762444746]
p(48) ∈ [0.0, 0.000047868849762444746]
p(49) ∈ [0.0, 0.000047868849762444746]
p(50) ∈ [0.0, 0.000047868849762444746]
p(51) ∈ [0.0, 0.000047868849762444746]
p(52) ∈ [0.0, 0.000047868849762444746]
p(53) ∈ [0.0, 0.000047868849762444746]
p(54) ∈ [0.0, 0.000047868849762444746]
p(55) ∈ [0.0, 0.000047868849762444746]
p(56) ∈ [0.0, 0.000047868849762444746]
p(57) ∈ [0.0, 0.000047868849762444746]
p(58) ∈ [0.0, 0.000047868849762444746]
p(59) ∈ [0.0, 0.000047868849762444746]
p(60) ∈ [0.0, 0.000047868849762444746]
p(61) ∈ [0.0, 0.000047868849762444746]
p(62) ∈ [0.0, 0.000047868849762444746]
p(63) ∈ [0.0, 0.000047868849762444746]
p(64) ∈ [0.0, 0.000047868849762444746]
p(65) ∈ [0.0, 0.000047868849762444746]
p(66) ∈ [0.0, 0.000047868849762444746]
p(67) ∈ [0.0, 0.000047868849762444746]
p(68) ∈ [0.0, 0.000047868849762444746]
p(69) ∈ [0.0, 0.000047868849762444746]
p(70) ∈ [0.0, 0.000047868849762444746]
p(71) ∈ [0.0, 0.000047868849762444746]
p(72) ∈ [0.0, 0.000047868849762444746]
p(73) ∈ [0.0, 0.000047868849762444746]
p(74) ∈ [0.0, 0.000047868849762444746]
p(75) ∈ [0.0, 0.000047868849762444746]
p(76) ∈ [0.0, 0.000047868849762444746]
p(77) ∈ [0.0, 0.000047868849762444746]
p(78) ∈ [0.0, 0.000047868849762444746]
p(79) ∈ [0.0, 0.000047868849762444746]
p(80) ∈ [0.0, 0.000047868849762444746]
p(81) ∈ [0.0, 0.000047868849762444746]
p(82) ∈ [0.0, 0.000047868849762444746]
p(83) ∈ [0.0, 0.000047868849762444746]
p(84) ∈ [0.0, 0.000047868849762444746]
p(85) ∈ [0.0, 0.000047868849762444746]
p(86) ∈ [0.0, 0.000047868849762444746]
p(87) ∈ [0.0, 0.000047868849762444746]
p(88) ∈ [0.0, 0.000047868849762444746]
p(89) ∈ [0.0, 0.000047868849762444746]
p(90) ∈ [0.0, 0.000047868849762444746]
p(91) ∈ [0.0, 0.000047868849762444746]
p(92) ∈ [0.0, 0.000047868849762444746]
p(93) ∈ [0.0, 0.000047868849762444746]
p(94) ∈ [0.0, 0.000047868849762444746]
p(95) ∈ [0.0, 0.000047868849762444746]
p(96) ∈ [0.0, 0.000047868849762444746]
p(97) ∈ [0.0, 0.000047868849762444746]
p(98) ∈ [0.0, 0.000047868849762444746]
p(99) ∈ [0.0, 0.000047868849762444746]
p(100) ∈ [0.0, 0.000047868849762444746]
p(101) ∈ [0.0, 0.000047868849762444746]
p(102) ∈ [0.0, 0.000047868849762444746]
p(103) ∈ [0.0, 0.000047868849762444746]
p(104) ∈ [0.0, 0.000047868849762444746]
p(105) ∈ [0.0, 0.000047868849762444746]
p(106) ∈ [0.0, 0.000047868849762444746]
p(107) ∈ [0.0, 0.000047868849762444746]
p(108) ∈ [0.0, 0.000047868849762444746]
p(109) ∈ [0.0, 0.000047868849762444746]
p(110) ∈ [0.0, 0.000047868849762444746]
p(111) ∈ [0.0, 0.000047868849762444746]
p(112) ∈ [0.0, 0.000047868849762444746]
p(113) ∈ [0.0, 0.000047868849762444746]
p(114) ∈ [0.0, 0.000047868849762444746]
p(115) ∈ [0.0, 0.000047868849762444746]
p(116) ∈ [0.0, 0.000047868849762444746]
p(117) ∈ [0.0, 0.000047868849762444746]
p(118) ∈ [0.0, 0.000047868849762444746]
p(119) ∈ [0.0, 0.000047868849762444746]
p(120) ∈ [0.0, 0.000047868849762444746]
p(121) ∈ [0.0, 0.000047868849762444746]
p(122) ∈ [0.0, 0.000047868849762444746]
p(123) ∈ [0.0, 0.000047868849762444746]
p(124) ∈ [0.0, 0.000047868849762444746]
p(125) ∈ [0.0, 0.000047868849762444746]
p(126) ∈ [0.0, 0.000047868849762444746]
p(127) ∈ [0.0, 0.000047868849762444746]
p(128) ∈ [0.0, 0.000047868849762444746]
p(129) ∈ [0.0, 0.000047868849762444746]
p(130) ∈ [0.0, 0.000047868849762444746]
p(131) ∈ [0.0, 0.000047868849762444746]
p(132) ∈ [0.0, 0.000047868849762444746]
p(133) ∈ [0.0, 0.000047868849762444746]
p(134) ∈ [0.0, 0.000047868849762444746]
p(135) ∈ [0.0, 0.000047868849762444746]
p(136) ∈ [0.0, 0.000047868849762444746]
p(137) ∈ [0.0, 0.000047868849762444746]
p(138) ∈ [0.0, 0.000047868849762444746]
p(139) ∈ [0.0, 0.000047868849762444746]
p(140) ∈ [0.0, 0.000047868849762444746]
p(141) ∈ [0.0, 0.000047868849762444746]
p(142) ∈ [0.0, 0.000047868849762444746]
p(143) ∈ [0.0, 0.000047868849762444746]
p(144) ∈ [0.0, 0.000047868849762444746]
p(145) ∈ [0.0, 0.000047868849762444746]
p(146) ∈ [0.0, 0.000047868849762444746]
p(147) ∈ [0.0, 0.000047868849762444746]
p(148) ∈ [0.0, 0.000047868849762444746]
p(149) ∈ [0.0, 0.000047868849762444746]
p(150) ∈ [0.0, 0.000047868849762444746]
p(151) ∈ [0.0, 0.000047868849762444746]
p(152) ∈ [0.0, 0.000047868849762444746]
p(153) ∈ [0.0, 0.000047868849762444746]
p(154) ∈ [0.0, 0.000047868849762444746]
p(155) ∈ [0.0, 0.000047868849762444746]
p(156) ∈ [0.0, 0.000047868849762444746]
p(157) ∈ [0.0, 0.000047868849762444746]
p(158) ∈ [0.0, 0.000047868849762444746]
p(159) ∈ [0.0, 0.000047868849762444746]
p(160) ∈ [0.0, 0.000047868849762444746]
p(161) ∈ [0.0, 0.000047868849762444746]
p(162) ∈ [0.0, 0.000047868849762444746]
p(163) ∈ [0.0, 0.000047868849762444746]
p(164) ∈ [0.0, 0.000047868849762444746]
p(165) ∈ [0.0, 0.000047868849762444746]
p(166) ∈ [0.0, 0.000047868849762444746]
p(167) ∈ [0.0, 0.000047868849762444746]
p(168) ∈ [0.0, 0.000047868849762444746]
p(169) ∈ [0.0, 0.000047868849762444746]
p(170) ∈ [0.0, 0.000047868849762444746]
p(171) ∈ [0.0, 0.000047868849762444746]
p(172) ∈ [0.0, 0.000047868849762444746]
p(173) ∈ [0.0, 0.000047868849762444746]
p(174) ∈ [0.0, 0.000047868849762444746]
p(175) ∈ [0.0, 0.000047868849762444746]
p(176) ∈ [0.0, 0.000047868849762444746]
p(177) ∈ [0.0, 0.000047868849762444746]
p(178) ∈ [0.0, 0.000047868849762444746]
p(179) ∈ [0.0, 0.000047868849762444746]
p(180) ∈ [0.0, 0.000047868849762444746]
p(181) ∈ [0.0, 0.000047868849762444746]
p(182) ∈ [0.0, 0.000047868849762444746]
p(183) ∈ [0.0, 0.000047868849762444746]
p(184) ∈ [0.0, 0.000047868849762444746]
p(185) ∈ [0.0, 0.000047868849762444746]
p(186) ∈ [0.0, 0.000047868849762444746]
p(187) ∈ [0.0, 0.000047868849762444746]
p(188) ∈ [0.0, 0.000047868849762444746]
p(189) ∈ [0.0, 0.000047868849762444746]
p(190) ∈ [0.0, 0.000047868849762444746]
p(191) ∈ [0.0, 0.000047868849762444746]
p(192) ∈ [0.0, 0.000047868849762444746]
p(193) ∈ [0.0, 0.000047868849762444746]
p(194) ∈ [0.0, 0.000047868849762444746]
p(195) ∈ [0.0, 0.000047868849762444746]
p(196) ∈ [0.0, 0.000047868849762444746]
p(197) ∈ [0.0, 0.000047868849762444746]
p(198) ∈ [0.0, 0.000047868849762444746]
p(199) ∈ [0.0, 0.000047868849762444746]
p(n) ∈ [0.0, 0.000047868849762444746] for all n >= 200

Moments:
0-th (raw) moment ∈ [0.9999521311502375, 1.0]
1-th (raw) moment ∈ [1.9978060132708202, inf]
2-th (raw) moment ∈ [9.897808079284232, inf]
3-th (raw) moment ∈ [105.14617495597001, inf]
4-th (raw) moment ∈ [1717.9064492166108, inf]
Total time: 0.02375s
"""
                          

indices = list(range(200))[1::2]

# Extracted bounds for rest_output
rest_bounds = parse_output(rest_output)[1::2]
rest_lowers = [lower for lower, _ in rest_bounds]
rest_uppers = [upper for _, upper in rest_bounds]

# Extracted bounds for geom_bound_output
geom_bounds = parse_output(geom_bound_output)[1::2]
geom_bound_lowers = [lower for lower, _ in geom_bounds]
geom_bound_uppers = [upper for _, upper in geom_bounds]

# Extracted bounds for geom_bound tail output
tail_bounds = parse_output(tail_output)[1::2]
tail_uppers = [upper for _, upper in tail_bounds]

# Exact solution
exact = [hitting_time_prob(i, 3/4) for i in indices]

fig, ax = plt.subplots(figsize=(6, 4))

# Plot rest bounds:
ax.plot(indices, rest_lowers, 'r--', marker='|', alpha=0.5, linewidth=1)
ax.plot(indices, rest_uppers, 'r-', marker='|', alpha=0.5, linewidth=1)
ax.fill_between(indices, rest_lowers, rest_uppers, color='red', alpha=0.2, label='Residual Mass Bounds')

# Plot geom_bound bounds:
ax.plot(indices, geom_bound_lowers, 'b-', marker='|', alpha=0.5, linewidth=1)
ax.plot(indices, geom_bound_uppers, 'b--', marker='|', alpha=0.5, linewidth=1)
ax.fill_between(indices, geom_bound_lowers, geom_bound_uppers, color='blue', alpha=0.2, label='Geometric Bound')

# Plot tail bounds:
ax.plot(indices, tail_uppers, 'k-', marker='|', alpha=0.5, linewidth=1, label='Geometric Bound (tail-optimized)')

# Plot exact masses:
ax.scatter(indices, exact, marker='x', color='green', zorder=5, s=20, label='Exact probability')

# Setting symmetrical logarithmic scale
linthresh = 1e-7
ax.set_yscale('symlog', linthresh=linthresh)

# Customizing the y-axis labels
ax.set_ylim(bottom=0, top=1)
ax.set_yticks([0, 1e-7, 1e-6, 1e-5, 1e-4, 1e-3, 1e-2, 1e-1, 1])
ax.yaxis.set_major_formatter(ticker.LogFormatterSciNotation())

plt.xlabel('Result value')
plt.ylabel('Probability Mass')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)

# save as pdf
plt.savefig('rest_vs_geom_bound_asym_rw.pdf', bbox_inches='tight')

plt.show()