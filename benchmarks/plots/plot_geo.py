import re
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.ticker as ticker
from util import parse_output

tail_output = """
Probability masses:
p(0) = 0.5
p(1) ∈ [0.25, 1.0]
p(2) ∈ [0.125, 1.0]
p(3) ∈ [0.0625, 1.0]
p(4) ∈ [0.03125, 1.0]
p(5) ∈ [0.015625, 1.0]
p(6) ∈ [0.0078125, 1.0]
p(7) ∈ [0.00390625, 1.0]
p(8) ∈ [0.001953125, 0.9379989822567241]
p(9) ∈ [0.0, 0.47125381289214213]
p(10) ∈ [0.0, 0.2367594852086953]
p(11) ∈ [0.0, 0.11894875394698604]
p(12) ∈ [0.0, 0.0597602501672486]
p(13) ∈ [0.0, 0.03002374872832896]
p(14) ∈ [0.0, 0.015084031361633388]
p(15) ∈ [0.0, 0.0075782675966793965]
p(16) ∈ [0.0, 0.003807346881613885]
p(17) ∈ [0.0, 0.0019128237545064655]
p(18) ∈ [0.0, 0.0009610090253329513]
p(19) ∈ [0.0, 0.00048281413517351184]
p(20) ∈ [0.0, 0.00024256742962698298]
p(21) ∈ [0.0, 0.00012186668456733568]
p(22) ∈ [0.0, 0.0000612262282297047]
p(23) ∈ [0.0, 0.0000307602609896606]
p(24) ∈ [0.0, 0.000015454057574838118]
p(25) ∈ [0.0, 7.764169998644951e-6]
p(26) ∈ [0.0, 3.900744867549116e-6]
p(27) ∈ [0.0, 1.9597472137223075e-6]
p(28) ∈ [0.0, 9.845835275316139e-7]
p(29) ∈ [0.0, 4.94658043598045e-7]
p(30) ∈ [0.0, 2.485178486681403e-7]
p(31) ∈ [0.0, 1.2485619491275728e-7]
p(32) ∈ [0.0, 6.272816818444854e-8]
p(33) ∈ [0.0, 3.1514840625456364e-8]
p(34) ∈ [0.0, 1.583316089715089e-8]
p(35) ∈ [0.0, 7.954632770459638e-9]
p(36) ∈ [0.0, 3.99643399848584e-9]
p(37) ∈ [0.0, 2.007821751818048e-9]
p(38) ∈ [0.0, 1.0087363355934521e-9]
p(39) ∈ [0.0, 5.06792494814409e-10]
p(40) ∈ [0.0, 2.5461423737562845e-10]
p(41) ∈ [0.0, 1.2791904090472665e-10]
p(42) ∈ [0.0, 6.426695221227805e-11]
p(43) ∈ [0.0, 3.228793084628746e-11]
p(44) ∈ [0.0, 1.622156399903887e-11]
p(45) ∈ [0.0, 8.149767782507817e-12]
p(46) ∈ [0.0, 4.0944704784777665e-12]
p(47) ∈ [0.0, 2.05707560589747e-12]
p(48) ∈ [0.0, 1.0334816359334563e-12]
p(49) ∈ [0.0, 5.192246161247461e-13]
p(50) ∈ [0.0, 2.608601765297825e-13]
p(51) ∈ [0.0, 1.3105702153921081e-13]
p(52) ∈ [0.0, 6.584348413475899e-14]
p(53) ∈ [0.0, 3.307998573511886e-14]
p(54) ∈ [0.0, 1.6619495013296092e-14]
p(55) ∈ [0.0, 8.349689649465056e-15]
p(56) ∈ [0.0, 4.194911890319649e-15]
p(57) ∈ [0.0, 2.1075377057484507e-15]
p(58) ∈ [0.0, 1.0588339629734128e-15]
p(59) ∈ [0.0, 5.319617096709712e-16]
p(60) ∈ [0.0, 2.672593347510222e-16]
p(61) ∈ [0.0, 1.3427197994332762e-16]
p(62) ∈ [0.0, 6.745868994509432e-17]
p(63) ∈ [0.0, 3.3891470514019973e-17]
p(64) ∈ [0.0, 1.7027187669039744e-17]
p(65) ∈ [0.0, 8.554515797618313e-18]
p(66) ∈ [0.0, 4.297817229369169e-18]
p(67) ∈ [0.0, 2.1592376908351857e-18]
p(68) ∈ [0.0, 1.0848082076788535e-18]
p(69) ∈ [0.0, 5.450112567237658e-19]
p(70) ∈ [0.0, 2.7381547065465554e-19]
p(71) ∈ [0.0, 1.375658044579268e-19]
p(72) ∈ [0.0, 6.911351835201645e-20]
p(73) ∈ [0.0, 3.4722861817417833e-20]
p(74) ∈ [0.0, 1.7444881428993502e-20]
p(75) ∈ [0.0, 8.764366533837543e-21]
p(76) ∈ [0.0, 4.403246938198501e-21]
p(77) ∈ [0.0, 2.2122059277072516e-21]
p(78) ∈ [0.0, 1.1114196263054288e-21]
p(79) ∈ [0.0, 5.583809220767825e-22]
p(80) ∈ [0.0, 2.8053243505854296e-22]
p(81) ∈ [0.0, 1.409404297467274e-22]
p(82) ∈ [0.0, 7.080894133702164e-23]
p(83) ∈ [0.0, 3.557464797205355e-23]
p(84) ∈ [0.0, 1.7872821630138575e-23]
p(85) ∈ [0.0, 8.979365116239258e-24]
p(86) ∈ [0.0, 4.511262942095916e-24]
p(87) ∈ [0.0, 2.2664735278357316e-24]
p(88) ∈ [0.0, 1.138683849359834e-24]
p(89) ∈ [0.0, 5.720785585486456e-25]
p(90) ∈ [0.0, 2.874141732449169e-25]
p(91) ∈ [0.0, 1.4439783793266356e-25]
p(92) ∈ [0.0, 7.25459547252739e-26]
p(93) ∈ [0.0, 3.6447329283806337e-26]
p(94) ∈ [0.0, 1.8311259627815057e-26]
p(95) ∈ [0.0, 9.199637826583509e-27]
p(96) ∈ [0.0, 4.6219286854382726e-27]
p(97) ∈ [0.0, 2.3220723658868748e-27]
p(98) ∈ [0.0, 1.166616890780558e-27]
p(99) ∈ [0.0, 5.861122115953902e-28]
p(100) ∈ [0.0, 2.9446472727768634e-28]
p(101) ∈ [0.0, 1.479400597621061e-28]
p(102) ∈ [0.0, 7.432557877051376e-29]
p(103) ∈ [0.0, 3.73414183315536e-29]
p(104) ∈ [0.0, 1.8760452943358213e-29]
p(105) ∈ [0.0, 9.425314044446867e-30]
p(106) ∈ [0.0, 4.735309168955767e-30]
p(107) ∈ [0.0, 2.3790350984440307e-30]
p(108) ∈ [0.0, 1.195235157343845e-30]
p(109) ∈ [0.0, 6.0049012403604736e-31]
p(110) ∈ [0.0, 3.016882383765871e-31]
p(111) ∈ [0.0, 1.5156917579764358e-31]
p(112) ∈ [0.0, 7.614885875431544e-32]
p(113) ∈ [0.0, 3.8257440268239785e-32]
p(114) ∈ [0.0, 1.9220665415356462e-32]
p(115) ∈ [0.0, 9.65652632321492e-33]
p(116) ∈ [0.0, 4.851470987910816e-33]
p(117) ∈ [0.0, 2.4373951831888467e-33]
p(118) ∈ [0.0, 1.2245554583003933e-33]
p(119) ∈ [0.0, 6.152207408941548e-34]
p(120) ∈ [0.0, 3.0908894934957243e-34]
p(121) ∈ [0.0, 1.552873176401232e-34]
p(122) ∈ [0.0, 7.801686560004439e-35]
p(123) ∈ [0.0, 3.9195933129330603e-35]
p(124) ∈ [0.0, 1.969216735461982e-35]
p(125) ∈ [0.0, 9.893410467938953e-36]
p(126) ∈ [0.0, 4.970482371213513e-36]
p(127) ∈ [0.0, 2.497186898553005e-36]
p(128) ∈ [0.0, 1.2545950152484512e-36]
p(129) ∈ [0.0, 6.303127143580327e-37]
p(130) ∈ [0.0, 3.166712070848723e-37]
p(131) ∈ [0.0, 1.5909666918067004e-37]
p(132) ∈ [0.0, 7.993069650187571e-38]
p(133) ∈ [0.0, 4.0157448148834083e-38]
p(134) ∈ [0.0, 2.017523570294993e-38]
p(135) ∈ [0.0, 1.0136105615102522e-38]
p(136) ∈ [0.0, 5.09241322149662e-39]
p(137) ∈ [0.0, 2.5584453638520306e-39]
p(138) ∈ [0.0, 1.2853714722491112e-39]
p(139) ∈ [0.0, 6.457749088627411e-40]
p(140) ∈ [0.0, 3.244394651041859e-40]
p(141) ∈ [0.0, 1.6299946788341912e-40]
p(142) ∈ [0.0, 8.189147556924322e-41]
p(143) ∈ [0.0, 4.1142550083073855e-41]
p(144) ∈ [0.0, 2.0670154195804815e-41]
p(145) ∈ [0.0, 1.0384754314344781e-41]
p(146) ∈ [0.0, 5.217335156173641e-42]
p(147) ∈ [0.0, 2.6212065599130054e-42]
p(148) ∈ [0.0, 1.3169029061897408e-42]
p(149) ∈ [0.0, 6.6161640629670266e-43]
p(150) ∈ [0.0, 3.3239828617850583e-43]
p(151) ∈ [0.0, 1.669980060997144e-43]
p(152) ∈ [0.0, 8.390035448709728e-44]
p(153) ∈ [0.0, 4.2151817542404915e-44]
p(154) ∈ [0.0, 2.117721352895402e-44]
p(155) ∈ [0.0, 1.0639502612188574e-44]
p(156) ∈ [0.0, 5.34532154950409e-45]
p(157) ∈ [0.0, 2.6855073502082982e-45]
p(158) ∈ [0.0, 1.3492078374016398e-45]
p(159) ∈ [0.0, 6.778465113360481e-46]
p(160) ∈ [0.0, 3.4055234500811147e-46]
p(161) ∈ [0.0, 1.7109463241454636e-46]
p(162) ∈ [0.0, 8.595851319235956e-47]
p(163) ∈ [0.0, 4.318584333106675e-47]
p(164) ∈ [0.0, 2.1696711529221923e-47]
p(165) ∈ [0.0, 1.0900500137822441e-47]
p(166) ∈ [0.0, 5.476447575690664e-48]
p(167) ∈ [0.0, 2.7513855025077274e-48]
p(168) ∈ [0.0, 1.3823052405381587e-48]
p(169) ∈ [0.0, 6.9447475690982e-49]
p(170) ∈ [0.0, 3.489064309683051e-49]
p(171) ∈ [0.0, 1.752917530260189e-49]
p(172) ∈ [0.0, 8.806716056697185e-50]
p(173) ∈ [0.0, 4.424523479537335e-50]
p(174) ∈ [0.0, 2.2228953329419564e-50]
p(175) ∈ [0.0, 1.1167900190986965e-50]
p(176) ∈ [0.0, 5.610790253033627e-51]
p(177) ∈ [0.0, 2.8188797110618713e-51]
p(178) ∈ [0.0, 1.4162145557196674e-51]
p(179) ∈ [0.0, 7.115109097992415e-52]
p(180) ∈ [0.0, 3.574654509225039e-52]
p(181) ∈ [0.0, 1.7959183315865616e-52]
p(182) ∈ [0.0, 9.0227535147946e-53]
p(183) ∈ [0.0, 4.533061418044467e-53]
p(184) ∈ [0.0, 2.2774251547567733e-53]
p(185) ∈ [0.0, 1.1441859832017028e-53]
p(186) ∈ [0.0, 5.748428489168348e-54]
p(187) ∈ [0.0, 2.8880296193295586e-54]
p(188) ∈ [0.0, 1.4509556999519227e-54]
p(189) ∈ [0.0, 7.28964976374343e-55]
p(190) ∈ [0.0, 3.662344321043391e-55]
p(191) ∈ [0.0, 1.8399739851137878e-55]
p(192) ∈ [0.0, 9.244090585483215e-56]
p(193) ∈ [0.0, 4.644261899568912e-56]
p(194) ∈ [0.0, 2.3332926470516576e-56]
p(195) ∈ [0.0, 1.1722539974092926e-56]
p(196) ∈ [0.0, 5.889443127412566e-57]
p(197) ∈ [0.0, 2.958875843262886e-57]
p(198) ∈ [0.0, 1.4865490788245383e-57]
p(199) ∈ [0.0, 7.46847208471311e-58]

Asymptotics: p(n) <= 231.09060405383826 * 0.5024033307140232^n for n >= 9

Moments:
0-th (raw) moment ∈ [0.998046875, 233.8370705566619]
1-th (raw) moment ∈ [0.98046875, 468.9234597427381]
2-th (raw) moment ∈ [2.80078125, 707.9060830054137]
3-th (raw) moment ∈ [10.91796875, 1029.6087651380383]
4-th (raw) moment ∈ [52.58203125, 1495.353239261232]
Total time: 0.08532s
"""

geom_bound_output = """
Probability masses:
p(0) ∈ [0.5, 0.507738146168416]
p(1) ∈ [0.25, 0.25535024946057044]
p(2) ∈ [0.125, 0.12869922829930136]
p(3) ∈ [0.0625, 0.06505769195645936]
p(4) ∈ [0.03125, 0.033018419685092795]
p(5) ∈ [0.015625, 0.016847707126527025]
p(6) ∈ [0.0078125, 0.008657894749822368]
p(7) ∈ [0.00390625, 0.004490766330625499]
p(8) ∈ [0.001953125, 0.0023572667820960995]
p(9) ∈ [0.0009765625, 0.0012559911001573793]
p(10) ∈ [0.00048828125, 0.0006814816218619375]
p(11) ∈ [0.000244140625, 0.0003777217389824916]
p(12) ∈ [0.0001220703125, 0.00021442993810959668]
p(13) ∈ [0.00006103515625, 0.00012489373766490667]
p(14) ∈ [0.000030517578125, 0.00007467018694523914]
p(15) ∈ [0.0000152587890625, 0.000045786445995041786]
p(16) ∈ [7.62939453125e-6, 0.00002873659210558166]
p(17) ∈ [3.814697265625e-6, 0.000018408473343046942]
p(18) ∈ [1.9073486328125e-6, 0.00001199766495490609]
p(19) ∈ [9.5367431640625e-7, 7.930243159162832e-6]
p(20) ∈ [4.76837158203125e-7, 5.300522686391116e-6]
p(21) ∈ [2.384185791015625e-7, 3.57357409742031e-6]
p(22) ∈ [1.1920928955078125e-7, 2.4251768461776386e-6]
p(23) ∈ [5.960464477539063e-8, 1.6539789829460392e-6]
p(24) ∈ [2.9802322387695312e-8, 1.1321723548332276e-6]
p(25) ∈ [1.4901161193847656e-8, 7.770933637027523e-7]
p(26) ∈ [7.450580596923828e-9, 5.344396463978204e-7]
p(27) ∈ [3.725290298461914e-9, 3.6809201375684994e-7]
p(28) ∈ [1.862645149230957e-9, 2.537902804257493e-7]
p(29) ∈ [9.313225746154785e-10, 1.7511718898309575e-7]
p(30) ∈ [4.656612873077393e-10, 1.2089991227041509e-7]
p(31) ∈ [2.3283064365386963e-10, 8.350255343418183e-8]
p(32) ∈ [1.1641532182693481e-10, 5.7690126097708675e-8]
p(33) ∈ [5.820766091346741e-11, 3.986537960074772e-8]
p(34) ∈ [2.9103830456733704e-11, 2.7552272243484198e-8]
p(35) ∈ [1.4551915228366852e-11, 1.904440916398792e-8]
p(36) ∈ [7.275957614183426e-12, 1.3164753377138237e-8]
p(37) ∈ [3.637978807091713e-12, 9.100879738545987e-9]
p(38) ∈ [1.8189894035458565e-12, 6.291763862296281e-9]
p(39) ∈ [9.094947017729282e-13, 4.3498547628294084e-9]
p(40) ∈ [4.547473508864641e-13, 3.007369009299187e-9]
p(41) ∈ [2.2737367544323206e-13, 2.0792448874094734e-9]
p(42) ∈ [1.1368683772161603e-13, 1.4375719732646274e-9]
p(43) ∈ [5.684341886080802e-14, 9.939331872050235e-10]
p(44) ∈ [2.842170943040401e-14, 6.872067531190352e-10]
p(45) ∈ [1.4210854715202004e-14, 4.751377633079243e-10]
p(46) ∈ [7.105427357601002e-15, 3.2851337487373747e-10]
p(47) ∈ [3.552713678800501e-15, 2.271368289075701e-10]
p(48) ∈ [1.7763568394002505e-15, 1.5704451785919346e-10]
p(49) ∈ [8.881784197001252e-16, 1.0858217169551311e-10]
p(50) ∈ [0.0, 7.50750493590657e-11]
p(51) ∈ [0.0, 5.190781274914448e-11]
p(52) ∈ [0.0, 3.5889700338570356e-11]
p(53) ∈ [0.0, 2.4814580352619586e-11]
p(54) ∈ [0.0, 1.7157106140974332e-11]
p(55) ∈ [0.0, 1.1862634263794185e-11]
p(56) ∈ [0.0, 8.201971271861142e-12]
p(57) ∈ [0.0, 5.670943843371838e-12]
p(58) ∈ [0.0, 3.920960340961972e-12]
p(59) ∈ [0.0, 2.7110002179558828e-12]
p(60) ∈ [0.0, 1.874418903189851e-12]
p(61) ∈ [0.0, 1.295996289990936e-12]
p(62) ∈ [0.0, 8.960677790924687e-13]
p(63) ∈ [0.0, 6.19552286475546e-13]
p(64) ∈ [0.0, 4.283660730060316e-13]
p(65) ∈ [0.0, 2.961775729155533e-13]
p(66) ∈ [0.0, 2.0478081768374014e-13]
p(67) ∈ [0.0, 1.4158797669389325e-13]
p(68) ∈ [0.0, 9.78956689939139e-14]
p(69) ∈ [0.0, 6.768626991884473e-14]
p(70) ∈ [0.0, 4.6799119742585644e-14]
p(71) ∈ [0.0, 3.235748714335788e-14]
p(72) ∈ [0.0, 2.237236469385617e-14]
p(73) ∈ [0.0, 1.5468528188773335e-14]
p(74) ∈ [0.0, 1.0695130693653689e-14]
p(75) ∈ [0.0, 7.39474494007462e-15]
p(76) ∈ [0.0, 5.112817626549129e-15]
p(77) ∈ [0.0, 3.5350650082175362e-15]
p(78) ∈ [0.0, 2.4441874373599796e-15]
p(79) ∈ [0.0, 1.6899412641807693e-15]
p(80) ∈ [0.0, 1.1684461808156654e-15]
p(81) ∈ [0.0, 8.078780644039443e-16]
p(82) ∈ [0.0, 5.58576832772436e-16]
p(83) ∈ [0.0, 3.862068941558487e-16]
p(84) ∈ [0.0, 2.670281979887857e-16]
p(85) ∈ [0.0, 1.8462658124472615e-16]
p(86) ∈ [0.0, 1.2765308966938016e-16]
p(87) ∈ [0.0, 8.826091666908493e-17]
p(88) ∈ [0.0, 6.102468362844272e-17]
p(89) ∈ [0.0, 4.219321702621667e-17]
p(90) ∈ [0.0, 2.9172909340437176e-17]
p(91) ∈ [0.0, 2.0170508422160912e-17]
p(92) ∈ [0.0, 1.3946137673849412e-17]
p(93) ∈ [0.0, 9.642531162192948e-18]
p(94) ∈ [0.0, 6.666964674255807e-18]
p(95) ∈ [0.0, 4.609621397133881e-18]
p(96) ∈ [0.0, 3.1871489445511967e-18]
p(97) ∈ [0.0, 2.203633990650444e-18]
p(98) ∈ [0.0, 1.5236196516801966e-18]
p(99) ∈ [0.0, 1.0534493717356729e-18]
p(100) ∈ [0.0, 7.283678558401912e-19]
p(101) ∈ [0.0, 5.036024963849457e-19]
p(102) ∈ [0.0, 3.4819696164734956e-19]
p(103) ∈ [0.0, 2.4074766302939656e-19]
p(104) ∈ [0.0, 1.6645589605350039e-19]
p(105) ∈ [0.0, 1.1508965438053073e-19]
p(106) ∈ [0.0, 7.957440294678871e-20]
p(107) ∈ [0.0, 5.50187211736824e-20]
p(108) ∈ [0.0, 3.804062069572295e-20]
p(109) ∈ [0.0, 2.6301753149581825e-20]
p(110) ∈ [0.0, 1.8185355708965e-20]
p(111) ∈ [0.0, 1.2573578665300638e-20]
p(112) ∈ [0.0, 8.693526977565025e-21]
p(113) ∈ [0.0, 6.010811505734816e-21]
p(114) ∈ [0.0, 4.155949023993674e-21]
p(115) ∈ [0.0, 2.8734742843882444e-21]
p(116) ∈ [0.0, 1.9867554715832577e-21]
p(117) ∈ [0.0, 1.3736671754159657e-21]
p(118) ∈ [0.0, 9.49770384833291e-22]
p(119) ∈ [0.0, 6.56682928769278e-22]
p(120) ∈ [0.0, 4.540386558933283e-22]
p(121) ∈ [0.0, 3.1392791256471087e-22]
p(122) ∈ [0.0, 2.170536208934383e-22]
p(123) ∈ [0.0, 1.5007354382111862e-22]
p(124) ∈ [0.0, 1.0376269450066599e-22]
p(125) ∈ [0.0, 7.17428035341925e-23]
p(126) ∈ [0.0, 4.960385699036282e-23]
p(127) ∈ [0.0, 3.429671698218033e-23]
p(128) ∈ [0.0, 2.371317206208994e-23]
p(129) ∈ [0.0, 1.6395578898658048e-23]
p(130) ∈ [0.0, 1.1336104959651243e-23]
p(131) ∈ [0.0, 7.83792243326935e-24]
p(132) ∈ [0.0, 5.4192359976029125e-24]
p(133) ∈ [0.0, 3.746926439723035e-24]
p(134) ∈ [0.0, 2.5906710375605723e-24]
p(135) ∈ [0.0, 1.7912218274963727e-24]
p(136) ∈ [0.0, 1.2384728083117067e-24]
p(137) ∈ [0.0, 8.562953361680111e-25]
p(138) ∈ [0.0, 5.920531301310089e-25]
p(139) ∈ [0.0, 4.093528179968384e-25]
p(140) ∈ [0.0, 2.83031574488717e-25]
p(141) ∈ [0.0, 1.9569151264076767e-25]
p(142) ∈ [0.0, 1.353035193646155e-25]
p(143) ∈ [0.0, 9.3550517880953e-26]
p(144) ∈ [0.0, 6.468197898245689e-26]
p(145) ∈ [0.0, 4.472191602841798e-26]
p(146) ∈ [0.0, 3.09212829402657e-26]
p(147) ∈ [0.0, 2.1379355438716193e-26]
p(148) ∈ [0.0, 1.4781949373121193e-26]
p(149) ∈ [0.0, 1.0220421653770825e-26]
p(150) ∈ [0.0, 7.066525269718982e-27]
p(151) ∈ [0.0, 4.885882508492505e-27]
p(152) ∈ [0.0, 3.37815927568916e-27]
p(153) ∈ [0.0, 2.335700883533068e-27]
p(154) ∈ [0.0, 1.6149323261924081e-27]
p(155) ∈ [0.0, 1.1165840782815713e-27]
p(156) ∈ [0.0, 7.720199686704166e-28]
p(157) ∈ [0.0, 5.337841042325636e-28]
p(158) ∈ [0.0, 3.6906489662704296e-28]
p(159) ∈ [0.0, 2.5517601000532093e-28]
p(160) ∈ [0.0, 1.764318326596017e-28]
p(161) ∈ [0.0, 1.2198713968047629e-28]
p(162) ∈ [0.0, 8.434340914053976e-29]
p(163) ∈ [0.0, 5.831607072747057e-29]
p(164) ∈ [0.0, 4.0320448743359703e-29]
p(165) ∈ [0.0, 2.7878054309651404e-29]
p(166) ∈ [0.0, 1.9275229723723412e-29]
p(167) ∈ [0.0, 1.3327130967446497e-29]
p(168) ∈ [0.0, 9.214542309961215e-30]
p(169) ∈ [0.0, 6.371047916424421e-30]
p(170) ∈ [0.0, 4.405020910208051e-30]
p(171) ∈ [0.0, 3.0456856507618694e-30]
p(172) ∈ [0.0, 2.1058245289506773e-30]
p(173) ∈ [0.0, 1.4559929865451037e-30]
p(174) ∈ [0.0, 1.0066914634738701e-30]
p(175) ∈ [0.0, 6.960388628216572e-31]
p(176) ∈ [0.0, 4.812498328795462e-31]
p(177) ∈ [0.0, 3.32742055102652e-31]
p(178) ∈ [0.0, 2.3006195050803925e-31]
p(179) ∈ [0.0, 1.5906766295361998e-31]
p(180) ∈ [0.0, 1.099813391204048e-31]
p(181) ∈ [0.0, 7.604245093010722e-32]
p(182) ∈ [0.0, 5.25766860969685e-32]
p(183) ∈ [0.0, 3.635216760017263e-32]
p(184) ∈ [0.0, 2.5134335906865675e-32]
p(185) ∈ [0.0, 1.7378189065021725e-32]
p(186) ∈ [0.0, 1.2015493717387069e-32]
p(187) ∈ [0.0, 8.307660178652087e-33]
p(188) ∈ [0.0, 5.7440184537810514e-33]
p(189) ∈ [0.0, 3.9714850256104824e-33]
p(190) ∈ [0.0, 2.745933606509529e-33]
p(191) ∈ [0.0, 1.898572277809202e-33]
p(192) ∈ [0.0, 1.312696230353344e-33]
p(193) ∈ [0.0, 9.0761432331261e-34]
p(194) ∈ [0.0, 6.275357092024794e-34]
p(195) ∈ [0.0, 4.3388590969671345e-34]
p(196) ∈ [0.0, 2.999940559121265e-34]
p(197) ∈ [0.0, 2.0741958098043714e-34]
p(198) ∈ [0.0, 1.4341245010101892e-34]
p(199) ∈ [0.0, 9.915713235346396e-35]

Asymptotics: p(n) <= 0.007738209465277095 * 0.6914123026530697^n for n >= 50

Moments:
0-th (raw) moment ∈ [0.9999999999999991, 1.0250760034665822]
1-th (raw) moment ∈ [0.9999999999999547, 1.0561845382925008]
2-th (raw) moment ∈ [2.999999999997688, 1.6539776538480193]
3-th (raw) moment ∈ [12.999999999881904, 2.583971143478398]
4-th (raw) moment ∈ [74.99999999396245, 4.255820612654088]
Total time: 0.38495s
"""

rest_output = """
p(0) = 0.5
p(1) = 0.25
p(2) = 0.125
p(3) = 0.0625
p(4) = 0.03125
p(5) = 0.015625
p(6) = 0.0078125
p(7) = 0.00390625
p(8) = 0.001953125
p(9) = 0.0009765625
p(10) = 0.00048828125
p(11) = 0.000244140625
p(12) = 0.0001220703125
p(13) = 0.00006103515625
p(14) = 0.000030517578125
p(15) = 0.0000152587890625
p(16) = 7.62939453125e-6
p(17) = 3.814697265625e-6
p(18) = 1.9073486328125e-6
p(19) = 9.5367431640625e-7
p(20) = 4.76837158203125e-7
p(21) = 2.384185791015625e-7
p(22) = 1.1920928955078125e-7
p(23) = 5.960464477539063e-8
p(24) = 2.9802322387695312e-8
p(25) = 1.4901161193847656e-8
p(26) = 7.450580596923828e-9
p(27) = 3.725290298461914e-9
p(28) = 1.862645149230957e-9
p(29) = 9.313225746154785e-10
p(30) = 4.656612873077393e-10
p(31) = 2.3283064365386963e-10
p(32) = 1.1641532182693481e-10
p(33) = 5.820766091346741e-11
p(34) = 2.9103830456733704e-11
p(35) = 1.4551915228366852e-11
p(36) = 7.275957614183426e-12
p(37) = 3.637978807091713e-12
p(38) = 1.8189894035458565e-12
p(39) = 9.094947017729282e-13
p(40) = 4.547473508864641e-13
p(41) = 2.2737367544323206e-13
p(42) = 1.1368683772161603e-13
p(43) = 5.684341886080802e-14
p(44) = 2.842170943040401e-14
p(45) = 1.4210854715202004e-14
p(46) = 7.105427357601002e-15
p(47) = 3.552713678800501e-15
p(48) = 1.7763568394002505e-15
p(49) = 8.881784197001252e-16
p(50) ∈ [0.0, 8.881784197001252e-16]
p(51) ∈ [0.0, 8.881784197001252e-16]
p(52) ∈ [0.0, 8.881784197001252e-16]
p(53) ∈ [0.0, 8.881784197001252e-16]
p(54) ∈ [0.0, 8.881784197001252e-16]
p(55) ∈ [0.0, 8.881784197001252e-16]
p(56) ∈ [0.0, 8.881784197001252e-16]
p(57) ∈ [0.0, 8.881784197001252e-16]
p(58) ∈ [0.0, 8.881784197001252e-16]
p(59) ∈ [0.0, 8.881784197001252e-16]
p(60) ∈ [0.0, 8.881784197001252e-16]
p(61) ∈ [0.0, 8.881784197001252e-16]
p(62) ∈ [0.0, 8.881784197001252e-16]
p(63) ∈ [0.0, 8.881784197001252e-16]
p(64) ∈ [0.0, 8.881784197001252e-16]
p(65) ∈ [0.0, 8.881784197001252e-16]
p(66) ∈ [0.0, 8.881784197001252e-16]
p(67) ∈ [0.0, 8.881784197001252e-16]
p(68) ∈ [0.0, 8.881784197001252e-16]
p(69) ∈ [0.0, 8.881784197001252e-16]
p(70) ∈ [0.0, 8.881784197001252e-16]
p(71) ∈ [0.0, 8.881784197001252e-16]
p(72) ∈ [0.0, 8.881784197001252e-16]
p(73) ∈ [0.0, 8.881784197001252e-16]
p(74) ∈ [0.0, 8.881784197001252e-16]
p(75) ∈ [0.0, 8.881784197001252e-16]
p(76) ∈ [0.0, 8.881784197001252e-16]
p(77) ∈ [0.0, 8.881784197001252e-16]
p(78) ∈ [0.0, 8.881784197001252e-16]
p(79) ∈ [0.0, 8.881784197001252e-16]
p(80) ∈ [0.0, 8.881784197001252e-16]
p(81) ∈ [0.0, 8.881784197001252e-16]
p(82) ∈ [0.0, 8.881784197001252e-16]
p(83) ∈ [0.0, 8.881784197001252e-16]
p(84) ∈ [0.0, 8.881784197001252e-16]
p(85) ∈ [0.0, 8.881784197001252e-16]
p(86) ∈ [0.0, 8.881784197001252e-16]
p(87) ∈ [0.0, 8.881784197001252e-16]
p(88) ∈ [0.0, 8.881784197001252e-16]
p(89) ∈ [0.0, 8.881784197001252e-16]
p(90) ∈ [0.0, 8.881784197001252e-16]
p(91) ∈ [0.0, 8.881784197001252e-16]
p(92) ∈ [0.0, 8.881784197001252e-16]
p(93) ∈ [0.0, 8.881784197001252e-16]
p(94) ∈ [0.0, 8.881784197001252e-16]
p(95) ∈ [0.0, 8.881784197001252e-16]
p(96) ∈ [0.0, 8.881784197001252e-16]
p(97) ∈ [0.0, 8.881784197001252e-16]
p(98) ∈ [0.0, 8.881784197001252e-16]
p(99) ∈ [0.0, 8.881784197001252e-16]
p(100) ∈ [0.0, 8.881784197001252e-16]
p(101) ∈ [0.0, 8.881784197001252e-16]
p(102) ∈ [0.0, 8.881784197001252e-16]
p(103) ∈ [0.0, 8.881784197001252e-16]
p(104) ∈ [0.0, 8.881784197001252e-16]
p(105) ∈ [0.0, 8.881784197001252e-16]
p(106) ∈ [0.0, 8.881784197001252e-16]
p(107) ∈ [0.0, 8.881784197001252e-16]
p(108) ∈ [0.0, 8.881784197001252e-16]
p(109) ∈ [0.0, 8.881784197001252e-16]
p(110) ∈ [0.0, 8.881784197001252e-16]
p(111) ∈ [0.0, 8.881784197001252e-16]
p(112) ∈ [0.0, 8.881784197001252e-16]
p(113) ∈ [0.0, 8.881784197001252e-16]
p(114) ∈ [0.0, 8.881784197001252e-16]
p(115) ∈ [0.0, 8.881784197001252e-16]
p(116) ∈ [0.0, 8.881784197001252e-16]
p(117) ∈ [0.0, 8.881784197001252e-16]
p(118) ∈ [0.0, 8.881784197001252e-16]
p(119) ∈ [0.0, 8.881784197001252e-16]
p(120) ∈ [0.0, 8.881784197001252e-16]
p(121) ∈ [0.0, 8.881784197001252e-16]
p(122) ∈ [0.0, 8.881784197001252e-16]
p(123) ∈ [0.0, 8.881784197001252e-16]
p(124) ∈ [0.0, 8.881784197001252e-16]
p(125) ∈ [0.0, 8.881784197001252e-16]
p(126) ∈ [0.0, 8.881784197001252e-16]
p(127) ∈ [0.0, 8.881784197001252e-16]
p(128) ∈ [0.0, 8.881784197001252e-16]
p(129) ∈ [0.0, 8.881784197001252e-16]
p(130) ∈ [0.0, 8.881784197001252e-16]
p(131) ∈ [0.0, 8.881784197001252e-16]
p(132) ∈ [0.0, 8.881784197001252e-16]
p(133) ∈ [0.0, 8.881784197001252e-16]
p(134) ∈ [0.0, 8.881784197001252e-16]
p(135) ∈ [0.0, 8.881784197001252e-16]
p(136) ∈ [0.0, 8.881784197001252e-16]
p(137) ∈ [0.0, 8.881784197001252e-16]
p(138) ∈ [0.0, 8.881784197001252e-16]
p(139) ∈ [0.0, 8.881784197001252e-16]
p(140) ∈ [0.0, 8.881784197001252e-16]
p(141) ∈ [0.0, 8.881784197001252e-16]
p(142) ∈ [0.0, 8.881784197001252e-16]
p(143) ∈ [0.0, 8.881784197001252e-16]
p(144) ∈ [0.0, 8.881784197001252e-16]
p(145) ∈ [0.0, 8.881784197001252e-16]
p(146) ∈ [0.0, 8.881784197001252e-16]
p(147) ∈ [0.0, 8.881784197001252e-16]
p(148) ∈ [0.0, 8.881784197001252e-16]
p(149) ∈ [0.0, 8.881784197001252e-16]
p(150) ∈ [0.0, 8.881784197001252e-16]
p(151) ∈ [0.0, 8.881784197001252e-16]
p(152) ∈ [0.0, 8.881784197001252e-16]
p(153) ∈ [0.0, 8.881784197001252e-16]
p(154) ∈ [0.0, 8.881784197001252e-16]
p(155) ∈ [0.0, 8.881784197001252e-16]
p(156) ∈ [0.0, 8.881784197001252e-16]
p(157) ∈ [0.0, 8.881784197001252e-16]
p(158) ∈ [0.0, 8.881784197001252e-16]
p(159) ∈ [0.0, 8.881784197001252e-16]
p(160) ∈ [0.0, 8.881784197001252e-16]
p(161) ∈ [0.0, 8.881784197001252e-16]
p(162) ∈ [0.0, 8.881784197001252e-16]
p(163) ∈ [0.0, 8.881784197001252e-16]
p(164) ∈ [0.0, 8.881784197001252e-16]
p(165) ∈ [0.0, 8.881784197001252e-16]
p(166) ∈ [0.0, 8.881784197001252e-16]
p(167) ∈ [0.0, 8.881784197001252e-16]
p(168) ∈ [0.0, 8.881784197001252e-16]
p(169) ∈ [0.0, 8.881784197001252e-16]
p(170) ∈ [0.0, 8.881784197001252e-16]
p(171) ∈ [0.0, 8.881784197001252e-16]
p(172) ∈ [0.0, 8.881784197001252e-16]
p(173) ∈ [0.0, 8.881784197001252e-16]
p(174) ∈ [0.0, 8.881784197001252e-16]
p(175) ∈ [0.0, 8.881784197001252e-16]
p(176) ∈ [0.0, 8.881784197001252e-16]
p(177) ∈ [0.0, 8.881784197001252e-16]
p(178) ∈ [0.0, 8.881784197001252e-16]
p(179) ∈ [0.0, 8.881784197001252e-16]
p(180) ∈ [0.0, 8.881784197001252e-16]
p(181) ∈ [0.0, 8.881784197001252e-16]
p(182) ∈ [0.0, 8.881784197001252e-16]
p(183) ∈ [0.0, 8.881784197001252e-16]
p(184) ∈ [0.0, 8.881784197001252e-16]
p(185) ∈ [0.0, 8.881784197001252e-16]
p(186) ∈ [0.0, 8.881784197001252e-16]
p(187) ∈ [0.0, 8.881784197001252e-16]
p(188) ∈ [0.0, 8.881784197001252e-16]
p(189) ∈ [0.0, 8.881784197001252e-16]
p(190) ∈ [0.0, 8.881784197001252e-16]
p(191) ∈ [0.0, 8.881784197001252e-16]
p(192) ∈ [0.0, 8.881784197001252e-16]
p(193) ∈ [0.0, 8.881784197001252e-16]
p(194) ∈ [0.0, 8.881784197001252e-16]
p(195) ∈ [0.0, 8.881784197001252e-16]
p(196) ∈ [0.0, 8.881784197001252e-16]
p(197) ∈ [0.0, 8.881784197001252e-16]
p(198) ∈ [0.0, 8.881784197001252e-16]
p(199) ∈ [0.0, 8.881784197001252e-16]
"""
                          

indices = list(range(200))[::2]

# Extracted bounds for rest_output
rest_bounds = parse_output(rest_output)[::2]
rest_lowers = [lower for lower, _ in rest_bounds]
rest_uppers = [upper for _, upper in rest_bounds]

# Extracted bounds for geom_bound_output
geom_bounds = parse_output(geom_bound_output)[::2]
geom_bound_lowers = [lower for lower, _ in geom_bounds]
geom_bound_uppers = [upper for _, upper in geom_bounds]

# Extracted bounds for geom_bound tail output
tail_bounds = parse_output(tail_output)[::2]
tail_uppers = [upper for _, upper in tail_bounds]

# Exact values
exact = [0.5**(i+1) for i in indices]

fig, ax = plt.subplots(figsize=(6, 4))

# Plot rest bounds:
ax.plot(indices, rest_lowers, 'r--', marker='|', alpha=0.5, linewidth=1)
ax.plot(indices, rest_uppers, 'r-', marker='|', alpha=0.5, linewidth=1)
ax.fill_between(indices, rest_lowers, rest_uppers, color='red', alpha=0.2, label='Residual Mass Bounds')

# Plot geom_bound bounds:
ax.plot(indices, geom_bound_lowers, 'b-', marker='|', alpha=0.5, linewidth=1)
ax.plot(indices, geom_bound_uppers, 'b--', marker='|', alpha=0.5, linewidth=1)
ax.fill_between(indices, geom_bound_lowers, geom_bound_uppers, color='blue', alpha=0.2, label='Geometric Bound')

# Plot tail bounds:
ax.plot(indices, tail_uppers, 'k-', marker='|', alpha=0.5, linewidth=1, label='Geometric Bound (tail-optimized)')

# Plot exact masses:
ax.scatter(indices, exact, marker='x', color='green', zorder=5, s=20, label='Exact probability')

# Setting symmetrical logarithmic scale
linthresh = 1e-40
ax.set_yscale('symlog', linthresh=linthresh)

# Customizing the y-axis labels
ax.set_ylim(bottom=0, top=1)
ax.set_yticks([0, 1e-40, 1e-35, 1e-30, 1e-25, 1e-20, 1e-15, 1e-10, 1e-5, 1])
ax.yaxis.set_major_formatter(ticker.LogFormatterSciNotation())

plt.xlabel('Result value')
plt.ylabel('Probability Mass')
plt.legend()
plt.grid(True, which='both', linestyle='--', linewidth=0.5)

# save as pdf
plt.savefig('rest_vs_geom_bound_geo.pdf', bbox_inches='tight')

plt.show()
