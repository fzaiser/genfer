import matplotlib.pyplot as plt
import numpy as np

from matplotlib import cm

traj = np.array([
[0.999, 1, 0.998],
[0.9095573166770746, 0.9999105573166771, 0.9532786583385373],
[0.8637005294460263, 0.9957627754421919, 0.8645095704173017],
[0.7935266295071692, 0.9861574099432393, 0.7939166478187663],
[0.737403065518998, 0.9744067286586209, 0.7376868684695007],
[0.7104684399441339, 0.9671480040425772, 0.7107231016687885],
[0.6905269606855932, 0.9611781963446719, 0.6907640671490795],
[0.6905238738215159, 0.9609404208155603, 0.6907602409353534],
[0.6905207835253777, 0.9607026382027314, 0.6907564137832595],
[0.6905176897999181, 0.9604648485013016, 0.6907525856865927],
[0.6905145926478576, 0.9602270517063832, 0.690748756639163],
[0.6905114920718982, 0.9599892478130836, 0.6907449266347953],
[0.6905083880747229, 0.9597514368165059, 0.6907410956673289],
[0.6905052806589961, 0.9595136187117487, 0.6907372637306184],
[0.6905021698273637, 0.9592757934939061, 0.6907334308185327],
[0.690499055582453, 0.9590379611580677, 0.6907295969249553],
[0.6904959379268728, 0.9588001216993186, 0.6907257620437842],
[0.6904928168632136, 0.9585622751127394, 0.6907219261689321],
[0.6904896923940474, 0.9583244213934061, 0.6907180892943259],
[0.6904865645219281, 0.9580865605363904, 0.6907142514139067],
[0.6904834332493912, 0.9578486925367592, 0.6907104125216301],
[0.6904802985789541, 0.957610817389575, 0.6907065726114656],
[0.6904771605131161, 0.9573729350898957, 0.690702731677397],
[0.6904740190543586, 0.9571350456327747, 0.6906988897134222],
[0.6904708742051445, 0.956897149013261, 0.6906950467135529],
[0.6904677259679195, 0.9566592452263987, 0.6906912026718147],
[0.6904645743451109, 0.9564213342672275, 0.6906873575822473],
[0.6904614193391284, 0.9561834161307827, 0.6906835114389039],
[0.690458260952364, 0.9559454908120948, 0.6906796642358517],
[0.6904550991871918, 0.9557075583061897, 0.6906758159671713],
[0.6904519340459686, 0.955469618608089, 0.690671966626957],
[0.6904487655310333, 0.9552316717128093, 0.6906681162093165],
[0.6904455936447075, 0.9549937176153629, 0.6906642647083711],
[0.6904424183892952, 0.9547557563107574, 0.6906604121182555],
[0.6904392397670831, 0.9545177877939958, 0.6906565584331176],
[0.6904360577803406, 0.9542798120600764, 0.6906527036471186],
[0.6904328724313197, 0.954041829103993, 0.6906488477544331],
[0.6904296837222552, 0.9538038389207347, 0.6906449907492487],
[0.6904264916553648, 0.953565841505286, 0.6906411326257659],
[0.6904232962328491, 0.9533278368526267, 0.6906372733781984],
[0.6904200974568916, 0.9530898249577319, 0.6906334130007729],
[0.6904168953296587, 0.952851805815572, 0.6906295514877289],
[0.6904136898532999, 0.9526137794211132, 0.6906256888333187],
[0.690410481029948, 0.9523757457693165, 0.6906218250318074],
[0.6904072688617187, 0.9521377048551384, 0.6906179600774729],
[0.6904040533507111, 0.9518996566735307, 0.6906140939646056],
[0.6904008344990075, 0.9516616012194407, 0.6906102266875086],
[0.6903976123086735, 0.9514235384878106, 0.6906063582404973],
[0.6903943867817581, 0.9511854684735783, 0.6906024886179],
])

traj_obj = 0.5 + 0.25 / (1 - traj[:, 2]) / (1 - traj[:, 0])

fig, ax = plt.subplots(subplot_kw={"projection": "3d"})


# Make data.
X = np.arange(0, 0.9, 1 / 32)
Y = np.arange(0, 0.9, 1 / 32)
Z = np.arange(0, 0.9, 1 / 32)
x0, x1, x2 = np.meshgrid(X, Y, Z)
obj = 0.5 + 0.5 * x1 / (1 - x2) / (1 - x0)
obj = np.where(np.logical_and(0.5 <= x1, 0.5 <= x0 * x2), obj, np.nan)

ax.scatter(x0.flatten(), x1.flatten(), x2.flatten(), c=obj.flatten(), cmap=cm.coolwarm, alpha=0.5)

ax.plot(traj[:,0], traj[:,1], traj[:,2], '->')
ax.plot(traj[0, 0], traj[0,1], traj[0,2], 'ro', label='start')
ax.plot(traj[-1, 0], traj[-1,1], traj[-1,2], 'go', label='end')

plt.show()